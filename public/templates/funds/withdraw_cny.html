<h2 class="panel-title">{{"funds.withdraw_cny.title" | t}}</h2>
  <div class="help-block">
    {{"funds.withdraw_cny.intro" | t}} <br />
    {{"funds.withdraw_cny.intro_2" | t}} <br />
    <span class="text-danger"><strong>{{"funds.withdraw_cny.attention" | t}}</strong> </span>
  </div>

  <form id="cny_withdraws" name="withdraw_form" class="form form-horizontal" ng-controller="WithdrawsController as withdrawsCtrl" ng-submit="withdrawsCtrl.createWithdraw(currency)">

    <div class="form-group">
      <div class="col-sm-6">
        <label class="optional control-label">{{"funds.withdraw_cny.account_name" | t}}</label>
      </div>
      <div class="col-sm-12">
        <p class="form-control-static">{{name}}</p>
      </div>
    </div>

    <div class="form-group">
      <div class="col-sm-6">
        <label class="select required control-label" for="withdraw_fund_source">{{"funds.withdraw_cny.withdraw_address" | t}}</label>
      </div>
<!-- Form for first time use -->
      <div class="col-sm-6">
        <select class="select required form-control" id="fund_source_extra" name="fund_source[extra]">
          <option value="">请选择开户银行</option>
        </select>     
      </div>

      <div class="col-sm-10">
        <input class="string required form-control" id="fund_source_uid" name="fund_source[uid]" type="text" placeholder="请输入银行账号"> 
      </div>


<!-- *************** Normal form
      <div class="col-sm-12">
        <select id="fund_source" class="select required form-control" name="fund_source"
          ng-model="withdrawsCtrl.withdraw.fund_source"
          ng-options="fs.id as fs.label for fs in fsources"
          ng-init="withdrawsCtrl.withdraw.fund_source=fsources[0].id" required>
        </select>
      </div>
-->

      <span class="col-sm-6 help-block"><a href="###" data-toggle="modal" data-target="#manage-withdraw">{{"funds.withdraw_cny.manage_withdraw" | t}}</a></span>

<!-- The manage dialog -->
      <div class="modal fade" id="manage-withdraw" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title" id="myModalLabel">管理银行账号</h4>
            </div>
            <div class="modal-body">
              <h5>通过增加提现银行账号，以便每次提现时快速选择。</h5>

              <table class="table table-condensed table-hover table-fundsource">
                <thead>
                  <tr>
                    <th>币种</th>
                    <th>银行</th>
                    <th>账号</th>
                    <th>操作</th>
                  </tr>
                </thead>
                <tbody>
                  <tr id="fundsource-1">
                    <td class="col-xs-2">CNY</td>
                    <td class="col-xs-3">工商银行</td>
                    <td class="col-xs-5">6222023700013665064</td>
                    <td class="col-xs-2">
                      <a data-confirm="确定移除以保存的地址?" data-method="delete" href="/cny_fund_sources/1" rel="nofollow">移除</a>
                    </td>
                  </tr>
                  <tr id="fundsource-2" class="add-fundsource">
                    <td class="col-xs-2">CNY</td>
                    <td class="col-xs-3">
                      <select class="select required form-control" id="fund_source_extra" name="fund_source[extra]">
                        <option value="">请选择开户银行</option>
                      </select>                       
                    </td>
                    <td class="col-xs-5">
                      <input class="string required form-control" id="fund_source_uid" name="fund_source[uid]" type="text" placeholder="请输入银行账号"> 
                    </td>
                    <td class="col-xs-2">
                      <button type="btn btn-success" class="btn btn-default">保存</button>
                    </td>
                  </tr>
                </tbody>
              </table>
              
              <div class="row">
                <div class="col-xs-3 col-xs-offset-9">
                  <a class="btn btn-default btn-block" href="/cny_fund_sources/new">新建</a>
                </div>
              </div>
            
            </div>
          </div>
        </div>
      </div>

<!-- *************** Former link to withdraw_manage page
      <span class="col-sm-6 help-block"><a href="/cny_fund_sources">{{"funds.withdraw_cny.manage_withdraw" | t}}</a></span>
-->
    </div>

    <div class="form-group">
      <div class="col-sm-6">
        <label class="optional control-label">{{"funds.withdraw_cny.balance" | t}}</label>
      </div>
      <div class="col-sm-12">
        <p class="form-control-static"><span class="currency-balance" id="withdraw_balance">{{balance}}</span></p>
      </div>
    </div>

    <div class="form-group required">
      <div class="col-sm-6">
        <label class="decimal required control-label" for="withdraw_sum">{{"funds.withdraw_cny.withdraw_amount" | t}}</label>
      </div>
      <div class="col-sm-12">
        <div class="input-group">
          <input class="numeric decimal required form-control" id="withdraw_sum" min="100" name="withdraw[sum]" placeholder="{{'funds.withdraw_cny.min' | t}} 100" step="any" type="number" value="0.0" ng-model="withdrawsCtrl.withdraw.sum">
          <div class="input-group-btn"><button ng-click="withdrawsCtrl.withdrawAll()" class="btn btn-success" id="withdraw_all_btn" type="button">{{"funds.withdraw_cny.withdraw_all" | t}}</button></div>
        </div>
      </div>
      <span class="col-sm-6 help-block"><a target="_balance" href="/documents/price">{{"funds.withdraw_cny.fee_explain" | t}}</a></span>
    </div>

    <ng-include src="'/templates/funds/_two_factor_auth.html'"></ng-include>

    <div class="form-group">
      <div class="form-submit col-sm-18 col-sm-offset-6">
        <input  id="withdraw_submit" class="btn btn-primary" data-loading-text="Creating..." name="commit" type="submit" value='{{ "submit" | t }}'>
      </div>
    </div>

  </form>

  <br>
  <h2 class="panel-title">{{ "funds.withdraw_history.title" | t }}</h2>

  <table class="table withdraw-history" ng-controller="WithdrawHistoryController as wdCtrl">
    <tr>
      <th>{{ "funds.withdraw_history.number" | t }}</th>
      <th>{{ "funds.withdraw_history.withdraw_time" | t }}</th>
      <th>{{ "funds.withdraw_history.withdraw_account" | t }}</th>
      <th>{{ "funds.withdraw_history.withdraw_amount" | t }}</th>
      <th>{{ "funds.withdraw_history.fee" | t }}</th>
      <th>{{ "funds.withdraw_history.state_and_action" | t }}</th>
    </tr>
    <tr ng-repeat="withdraw in wdCtrl.withdraws | orderBy:predicate">
      <td>{{withdraw.id}}</td>
      <td>{{withdraw.created_at | date:'yyyy-MM-dd HH:mm'}}</td>
      <td>{{withdraw.fund_extra}} @ {{withdraw.fund_uid}}</td>
      <td>{{withdraw.amount}}</td>
      <td>{{withdraw.fee}}</td>
      <td>{{"funds.withdraw_history." + withdraw.aasm_state | t}}
        <span ng-if="wdCtrl.canCancel(withdraw.aasm_state)">/
          <a ng-click="wdCtrl.cancelWithdraw(withdraw); $event.preventDefault()" href="#" class="cancel_link">{{ "funds.withdraw_history.cancel" | t }}</a>
        </span>
      </td>
    </tr>
    <tr ng-if="wdCtrl.noWithdraw()"><td colspan="6"><span class="help-block text-center">{{"funds.withdraw_history.no_data" | t}}</span></td></tr>
  </table>

